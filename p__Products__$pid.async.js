(self.webpackChunk=self.webpackChunk||[]).push([[20],{38235:function(t,v,r){"use strict";r.r(v);var F=r(94434),b=r.n(F),g=r(35290),i=r.n(g),D=r(30279),c=r.n(D),x=r(411),w=r.n(x),M=r(67116),m=r(39722),O=r(5223),W=r(93236),R=r(63169),p=r(62086),j=M.Z.ProductsController,L=j.addOrEditProduct,K=j.getProductDetail,B=M.Z.FileController,U=B.uploadFile,S=B.deleteFile,$=M.Z.CompanyController.getCompanys,z=function(){var P=(0,W.useRef)(),y=(0,R.useParams)();return(0,p.jsx)(m._zJ,{header:{title:"".concat(y.pid=="create"?"\u65B0\u5EFA\u4EA7\u54C1":"\u4FEE\u6539\u4EA7\u54C1")},children:(0,p.jsx)(m.QWM,{children:(0,p.jsxs)(m.A96,{submitter:{render:function(n,e){return(0,p.jsx)(m.Scc,{children:e})}},formRef:P,onFinish:function(){var f=w()(i()().mark(function n(e){var a,s,E;return i()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return console.log("values",JSON.stringify(e)),console.log("values",e),a=O.ZP.loading("\u63D0\u4EA4\u4E2D..."),s=c()(c()({},e),{},{price:e.price*100}),y.pid!="create"&&(s.id=y.pid),l.next=7,L(s);case 7:E=l.sent,E.code==0&&(a(),O.ZP.success("\u63D0\u4EA4\u6210\u529F"),R.history.back()),console.log("\u521B\u5EFA\u4EA7\u54C1\u6216\u8005\u66F4\u65B0\u4EA7\u54C1",E);case 10:case"end":return l.stop()}},n)}));return function(n){return f.apply(this,arguments)}}(),params:{},request:w()(i()().mark(function f(){var n,e,a,s,E,u,l,h,o,A,d,I,T;return i()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(y.pid==="create"){_.next=17;break}return _.prev=1,_.next=4,K(y.pid);case 4:return n=_.sent,console.log("\u8BF7\u6C42\u5230\u8FD9",n),e=n.data,a=e.description,s=e.detailPicture,E=e.downloadUrl,u=e.thumbnail,l=e.mainPicture,h=e.name,o=e.price,A=e.quantitySold,d=e.topFlag,I=e.company,T=e.showProduct,console.log("\u8BE6\u60C5",e),_.abrupt("return",{description:a,downloadUrl:E,name:h,price:o/100,quantitySold:A,topFlag:d,detailPicture:s.map(function(C){return c()(c()({},C),{},{url:C.downloadUrl})}),mainPicture:l.map(function(C){return c()(c()({},C),{},{url:C.downloadUrl})}),thumbnail:u.map(function(C){return c()(c()({},C),{},{url:C.downloadUrl})}),company:I,showProduct:T});case 12:_.prev=12,_.t0=_.catch(1),console.log("qingqiubaocuo",_.t0);case 15:_.next=18;break;case 17:return _.abrupt("return",{});case 18:case"end":return _.stop()}},f,null,[[1,12]])})),children:[(0,p.jsx)(m._IT,{width:"md",valueType:"select",name:"company",label:"\u4EA7\u54C1\u5F52\u5C5E\u516C\u53F8(\u907F\u514D\u672C\u4EA7\u54C1\u4E0A\u67B6\u672C\u516C\u53F8",fieldNames:{label:"companyName",value:"companyCode"},request:w()(i()().mark(function f(){var n;return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,$();case 2:return n=a.sent,console.log(n),a.abrupt("return",n.data.map(function(s){return{label:s.companyName,value:s.companyCode}}));case 5:case"end":return a.stop()}},f)})),placeholder:"\u8BF7\u9009\u62E9\u4EA7\u54C1\u6240\u5C5E\u516C\u53F8",rules:[{required:!0,message:"Please select your country!"}]}),(0,p.jsx)(m.VaQ,{width:"md",name:"name",label:"\u5546\u54C1\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u540D\u79F0",rules:[{required:!0,message:"\u5FC5\u586B"}]}),(0,p.jsx)(m.k_F,{name:"price",width:"md",label:"\u91D1\u989D (\u5355\u4F4D\u4E3A\u5143)",rules:[{required:!0,message:"\u5FC5\u586B"}]}),(0,p.jsx)(m.VaQ,{width:"md",name:"downloadUrl",label:"\u89C6\u9891\u94FE\u63A5",placeholder:"\u8BF7\u8F93\u5165\u89C6\u9891\u94FE\u63A5"}),(0,p.jsx)(m.rCM,{tooltip:"\u8BF7\u4E0A\u4F20\u6B63\u65B9\u5F62\u56FE\u7247",width:"md",maxCount:1,onRemove:function(n){console.log("shanchu wen",n)},label:"\u7F29\u7565\u56FE (\u8BF7\u4E0A\u4F20\u6B63\u65B9\u5F62\u56FE\u7247)",name:"thumbnail",action:function(n){return new Promise(function(){var e=w()(i()().mark(function a(s,E){var u,l;return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,U({multipartFile:n});case 2:u=o.sent,u.code==0&&((l=P.current)===null||l===void 0||l.setFieldsValue({thumbnail:[{id:u.data.id,fileId:u.data.fileId,url:u.data.downloadUrl}]}));case 4:case"end":return o.stop()}},a)}));return function(a,s){return e.apply(this,arguments)}}())},rules:[{required:!0,message:"\u5FC5\u586B"}]}),(0,p.jsx)(m.rCM,{width:"sm",label:"\u8F6E\u64AD\u56FE",name:"mainPicture",onRemove:function(n){console.log("shanchu wen",n)},action:function(n){return new Promise(function(){var e=w()(i()().mark(function a(s,E){var u,l,h,o;return i()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,U({multipartFile:n});case 2:u=d.sent,u.code==0&&(h=P.current.getFieldsValue().mainPicture,o=h?b()(h):[],console.log("\u4E0A\u4E00\u6B21\u7ED3\u679C",o),(l=P.current)===null||l===void 0||l.setFieldsValue({mainPicture:[].concat(b()(o),[{id:u.data.id,fileId:u.data.fileId,url:u.data.downloadUrl}])}),console.log("\u6240\u6709",P.current.getFieldsValue()));case 4:case"end":return d.stop()}},a)}));return function(a,s){return e.apply(this,arguments)}}())},rules:[{required:!0,message:"\u5FC5\u586B"}]}),(0,p.jsx)(m.rCM,{fieldProps:{onRemove:function(n){return console.log("shanchu wen",n),S({downloadUrl:n.fileId,id:n.id,fileId:n.fileId})}},width:"sm",label:"\u8BE6\u60C5\u56FE",name:"detailPicture",action:function(n){return new Promise(function(){var e=w()(i()().mark(function a(s,E){var u,l,h,o;return i()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,U({multipartFile:n});case 2:u=d.sent,u.code==0&&(h=P.current.getFieldsValue().detailPicture,o=h?b()(h):[],console.log("\u4E0A\u4E00\u6B21\u7ED3\u679C",o),(l=P.current)===null||l===void 0||l.setFieldsValue({detailPicture:[].concat(b()(o),[{id:u.data.id,fileId:u.data.fileId,url:u.data.downloadUrl}])}),console.log("\u6240\u6709",P.current.getFieldsValue()));case 4:case"end":return d.stop()}},a)}));return function(a,s){return e.apply(this,arguments)}}())},rules:[{required:!0,message:"\u5FC5\u586B"}]}),(0,p.jsx)(m.$JJ,{name:"description",width:"lg",label:"\u4EA7\u54C1\u7B80\u4ECB",placeholder:"\u8BF7\u8F93\u5165\u7B80\u4ECB"})]})})})};v.default=z},13989:function(t,v,r){var F=r(33737);function b(g){if(Array.isArray(g))return F(g)}t.exports=b,t.exports.__esModule=!0,t.exports.default=t.exports},56037:function(t){function v(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}t.exports=v,t.exports.__esModule=!0,t.exports.default=t.exports},90623:function(t){function v(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t.exports=v,t.exports.__esModule=!0,t.exports.default=t.exports},94434:function(t,v,r){var F=r(13989),b=r(56037),g=r(94945),i=r(90623);function D(c){return F(c)||b(c)||g(c)||i()}t.exports=D,t.exports.__esModule=!0,t.exports.default=t.exports}}]);
